import re
from typing import List, Dict

class MalwareScanner:
    # Known malicious patterns (simplified examples)
    PATTERNS = [
        (r"<script>.*?eval\(.*?\)</script>", "Potential malicious script (eval)"),
        (r"<iframe.*?src=.*?hidden", "Hidden iframe detected"),
        (r"document\.write\(unescape\(", "Potential obfuscated code")
    ]

    @classmethod
    def scan_for_malware(cls, html: str) -> List[Dict]:
        """Scan HTML for malicious patterns"""
        anomalies = []
        
        for pattern, message in cls.PATTERNS:
            if re.search(pattern, html, re.IGNORECASE):
                anomalies.append({
                    "type": "malware",
                    "message": message,
                    "severity": "high"
                })
                
        return anomalies